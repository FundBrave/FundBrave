# =============================================================================
# FundBrave Backend - Security Configuration Example
# =============================================================================
# This file documents all security-related environment variables.
# Copy this to .env and update with your actual values.
# NEVER commit your actual .env file to version control!
# =============================================================================

# =============================================================================
# REQUIRED SECURITY VARIABLES (Application will fail to start without these)
# =============================================================================

# Database connection string
DATABASE_URL="postgresql://user:password@localhost:5432/fundbrave?schema=public"

# JWT Configuration
# JWT_SECRET must be at least 32 characters for production security
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET="your-super-secret-jwt-key-at-least-32-chars"

# JWT Refresh Token Secret (should be different from JWT_SECRET)
JWT_REFRESH_SECRET="your-refresh-token-secret-at-least-32-chars"

# Wallet Encryption Key (CRITICAL for CWE-326 compliance)
# Must be exactly 64 hex characters (32 bytes)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# NEVER use weak or default values like '0000...0000'
WALLET_ENCRYPTION_KEY="generate-64-hex-characters-here-using-crypto-randomBytes"

# =============================================================================
# RECOMMENDED SECURITY VARIABLES
# =============================================================================

# Frontend URL for CORS and redirect validation
# Used for CWE-601 (Open Redirect) protection
FRONTEND_URL="https://your-frontend-domain.com"

# Additional allowed redirect domains (comma-separated)
# Used for CWE-601 protection
ALLOWED_REDIRECT_DOMAINS="staging.your-domain.com,preview.your-domain.com"

# Additional allowed CORS origins (comma-separated)
ALLOWED_ORIGINS="https://admin.your-domain.com"

# Cookie domain for HttpOnly cookies
# Leave empty for localhost development
COOKIE_DOMAIN=".your-domain.com"

# =============================================================================
# GOOGLE OAUTH CONFIGURATION
# Required for Google Sign-In functionality
# =============================================================================

# Google OAuth Client ID from Google Cloud Console
GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"

# Google OAuth Client Secret
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# Google OAuth Callback URL (must match Google Console settings)
GOOGLE_CALLBACK_URL="https://your-backend-domain.com/auth/google/callback"

# =============================================================================
# JWT TOKEN EXPIRATION
# =============================================================================

# Access token expiration (15 minutes recommended for security)
JWT_EXPIRES_IN="15m"

# Refresh token expiration (7 days default)
JWT_REFRESH_EXPIRES_IN="7d"

# =============================================================================
# ENVIRONMENT & FEATURE FLAGS
# =============================================================================

# Node environment (development, staging, production)
NODE_ENV="production"

# Enable Swagger documentation in production (set to "true" if needed)
ENABLE_SWAGGER="false"

# Server port
PORT=3000

# =============================================================================
# SECURITY NOTES
# =============================================================================
#
# 1. WALLET_ENCRYPTION_KEY Security (CWE-326):
#    - Must be exactly 64 hex characters (32 bytes)
#    - Never use weak keys like all zeros or sequential patterns
#    - Store securely using a secrets manager in production
#    - Rotate periodically and re-encrypt existing data
#
# 2. JWT Secrets:
#    - Use cryptographically random values
#    - JWT_SECRET and JWT_REFRESH_SECRET should be different
#    - Minimum 32 characters recommended
#
# 3. CORS Configuration:
#    - In production, FRONTEND_URL must be set
#    - Only add trusted origins to ALLOWED_ORIGINS
#
# 4. OAuth Security (CWE-352, CWE-598):
#    - State validation is enforced automatically
#    - One-time code exchange pattern is used
#    - Tokens are delivered via HttpOnly cookies
#
# 5. Cookie Security (CWE-522):
#    - HttpOnly cookies are used in production
#    - Secure flag is set in production (HTTPS only)
#    - SameSite=Strict in production
#
# =============================================================================
